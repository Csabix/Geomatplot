<svg xmlns="http://www.w3.org/2000/svg" onload="makeDraggable(evt)">

<style>
    .hover {
        fill: #a9a9a9;
    }

    .draggable {
        cursor: move;
    }
</style>

<line id="seg1" x1="250" y1="500" x2="875" y2="500" stroke="rgb(0,0,256)" stroke-width="2" />
<line id="seg2" x1="875" y1="500" x2="625" y2="156.25" stroke="rgb(0,0,256)" stroke-width="2" />
<line id="seg3" x1="625" y1="156.25" x2="250" y2="500" stroke="rgb(0,0,256)" stroke-width="2" />
<circle id="D" r="5" cx="750" cy="328.125" fill="rgb(0,0,0)" />
<line id="seg4" x1="250" y1="500" x2="750" y2="328.125" stroke="rgb(0,0,0)" stroke-width="1" />
<circle id="E" r="5" cx="437.5" cy="328.125" fill="rgb(0,0,0)" />
<line id="seg5" x1="875" y1="500" x2="437.5" y2="328.125" stroke="rgb(0,0,0)" stroke-width="1" />
<circle id="F" r="5" cx="562.5" cy="500" fill="rgb(0,0,0)" />
<line id="seg6" x1="625" y1="156.25" x2="562.5" y2="500" stroke="rgb(0,0,0)" stroke-width="1" />
<circle id="S" r="5" cx="583.3333" cy="385.4167" fill="rgb(0,0,0)" />
<line id="perpbi11" x1="562.5" y1="62500000812.5" x2="562.5" y2="6250812.5" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpbi12" x1="562.5" y1="6250812.5" x2="562.5" y2="812.5" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpbi13" x1="562.5" y1="812.5" x2="562.5" y2="187.5" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpbi14" x1="562.5" y1="187.5" x2="562.5" y2="-6249187.5" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpbi15" x1="562.5" y1="-6249187.5" x2="562.5" y2="-62499999187.5" stroke="rgb(0,0,0)" stroke-width="1" />
<line id="perpbi21" x1="34375000921.875" y1="-24999999796.875" x2="3438421.875" y2="-2499796.875" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpbi22" x1="3438421.875" y1="-2499796.875" x2="921.875" y2="203.125" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpbi23" x1="921.875" y1="203.125" x2="578.125" y2="453.125" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpbi24" x1="578.125" y1="453.125" x2="-3436578.125" y2="2500203.125" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpbi25" x1="-3436578.125" y1="2500203.125" x2="-34374999078.125" y2="25000000203.125" stroke="rgb(0,0,0)" stroke-width="1" />
<line id="perpbi31" x1="-34374999734.375" y1="-37499999859.375" x2="-3437234.375" y2="-3749859.375" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpbi32" x1="-3437234.375" y1="-3749859.375" x2="265.625" y2="140.625" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpbi33" x1="265.625" y1="140.625" x2="609.375" y2="515.625" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpbi34" x1="609.375" y1="515.625" x2="3437765.625" y2="3750140.625" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpbi35" x1="3437765.625" y1="3750140.625" x2="34375000265.625" y2="37500000140.625" stroke="rgb(0,0,0)" stroke-width="1" />
<circle id="center1" class="draggable" r="5" cx="562.5" cy="464.4886" fill="rgb(0,0,0)" />

<circle id="circ1" r="314.5112" cx="562.5" cy="464.4886" fill="none" stroke-width="2" stroke="rgb(256,0,256)" />
<circle id="dist1" r="0" cx="0" cy="0" value="0" visibility="hidden" />
<line id="angbi11" x1="99260731979.6904" y1="50546005768.9493" x2="9926948.1105" y2="5055100.5269" stroke="rgb(0,0,0)" stroke-width="1" /><line id="angbi12" x1="9926948.1105" y1="5055100.5269" x2="875" y2="500" stroke="rgb(0,0,0)" stroke-width="1" /><line id="angbi13" x1="875" y1="500" x2="-117.6073" y2="-5.4601" stroke="rgb(0,0,0)" stroke-width="1" /><line id="angbi14" x1="-117.6073" y1="-5.4601" x2="-9925198.1105" y2="-5054100.5269" stroke="rgb(0,0,0)" stroke-width="1" /><line id="angbi15" x1="-9925198.1105" y1="-5054100.5269" x2="-99260730229.6904" y2="-50546004768.9493" stroke="rgb(0,0,0)" stroke-width="1" />
<line id="angbi21" x1="9311403282.8559" y1="-92778794395.0334" x2="931765.2658" y2="-9277723.2051" stroke="rgb(0,0,0)" stroke-width="1" /><line id="angbi22" x1="931765.2658" y1="-9277723.2051" x2="625" y2="156.25" stroke="rgb(0,0,0)" stroke-width="1" /><line id="angbi23" x1="625" y1="156.25" x2="531.886" y2="1084.0379" stroke="rgb(0,0,0)" stroke-width="1" /><line id="angbi24" x1="531.886" y1="1084.0379" x2="-930515.2658" y2="9278035.7051" stroke="rgb(0,0,0)" stroke-width="1" /><line id="angbi25" x1="-930515.2658" y1="9278035.7051" x2="-9311402032.8559" y2="92778794707.5334" stroke="rgb(0,0,0)" stroke-width="1" />
<line id="angbi31" x1="-108572133512.5463" y1="42232789782.3341" x2="-10856963.3763" y2="4223778.9282" stroke="rgb(0,0,0)" stroke-width="1" /><line id="angbi32" x1="-10856963.3763" y1="4223778.9282" x2="250" y2="500" stroke="rgb(0,0,0)" stroke-width="1" /><line id="angbi33" x1="250" y1="500" x2="1335.7213" y2="77.6721" stroke="rgb(0,0,0)" stroke-width="1" /><line id="angbi34" x1="1335.7213" y1="77.6721" x2="10857463.3763" y2="-4222778.9282" stroke="rgb(0,0,0)" stroke-width="1" /><line id="angbi35" x1="10857463.3763" y1="-4222778.9282" x2="108572134012.5463" y2="-42232788782.3341" stroke="rgb(0,0,0)" stroke-width="1" />

<circle id="O" r="5" cx="604.3336" cy="362.17" fill="rgb(0,0,0)" />

<circle id="circ2" r="137.83" cx="604.3336" cy="362.17" fill="none" stroke-width="2" stroke="rgb(0,256,256)" />
<line id="perpln11" x1="34375000250" y1="-24999999500" x2="3437750" y2="-2499500" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpln12" x1="3437750" y1="-2499500" x2="250" y2="500" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpln13" x1="250" y1="500" x2="-93.75" y2="750" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpln14" x1="-93.75" y1="750" x2="-3437250" y2="2500500" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpln15" x1="-3437250" y1="2500500" x2="-34374999750" y2="25000000500" stroke="rgb(0,0,0)" stroke-width="1" />
<line id="perpln21" x1="-34374999125" y1="-37499999500" x2="-3436625" y2="-3749500" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpln22" x1="-3436625" y1="-3749500" x2="875" y2="500" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpln23" x1="875" y1="500" x2="1218.75" y2="875" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpln24" x1="1218.75" y1="875" x2="3438375" y2="3750500" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpln25" x1="3438375" y1="3750500" x2="34375000875" y2="37500000500" stroke="rgb(0,0,0)" stroke-width="1" />
<line id="perpln31" x1="625" y1="62500000156.25" x2="625" y2="6250156.25" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpln32" x1="625" y1="6250156.25" x2="625" y2="156.25" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpln33" x1="625" y1="156.25" x2="625" y2="-468.75" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpln34" x1="625" y1="-468.75" x2="625" y2="-6249843.75" stroke="rgb(0,0,0)" stroke-width="1" /><line id="perpln35" x1="625" y1="-6249843.75" x2="625" y2="-62499999843.75" stroke="rgb(0,0,0)" stroke-width="1" />

<circle id="M" r="5" cx="625" cy="227.2727" fill="rgb(0,0,0)" />
<line id="seg7" x1="625" y1="227.2727" x2="562.5" y2="464.4886" stroke="rgb(256,0,0)" stroke-width="1" />

<g id="pointseq">
    <circle id="S1" class="draggable" r="5" cx="1090" cy="389" fill="rgb(120,0,0)" />
    <circle id="S2" class="draggable" r="5" cx="1089" cy="388" fill="rgb(0,120,0)" />
    <circle id="S3" class="draggable" r="5" cx="1088" cy="387" fill="rgb(0,0,120)" />
    <circle id="S4" class="draggable" r="5" cx="1087" cy="386" fill="rgb(240,0,0)" />
    <circle id="S5" class="draggable" r="5" cx="1086" cy="385" fill="rgb(0,0,240)" />
    <circle id="S6" class="draggable" r="5" cx="1085" cy="384" fill="rgb(0,240,240)" />
    <circle id="S7" class="draggable" r="5" cx="1084" cy="383" fill="rgb(240,240,0)" />
    <circle id="S8" class="draggable" r="5" cx="1083" cy="382" fill="rgb(240,0,240)" />
    <circle id="S9" class="draggable" r="5" cx="1082" cy="381" fill="rgb(0,240,240)" />
    <circle id="S10" class="draggable" r="5" cx="1081" cy="380" fill="rgb(240,240,240)" />
</g>

<circle id="A" class="draggable" r="5" cx="250" cy="500" fill="rgb(0,0,256)" />
<circle id="B" class="draggable" r="5" cx="875" cy="500" fill="rgb(0,0,256)" />
<circle id="C" class="draggable" r="5" cx="625" cy="156.25" fill="rgb(0,0,256)" />

<script type="text/javascript" href="https://cdnjs.cloudflare.com/ajax/libs/mathjs/12.4.1/math.min.js"></script>
<script type="text/javascript"><![CDATA[

<!-- --------------------------------------------------------------------- -->

let A = document.getElementById("A");
let B = document.getElementById("B");
let C = document.getElementById("C");


function makeDraggable(evt) {
    // console.log(evt)
    var svg = evt.target;
    svg.addEventListener('mousedown', startDrag);
    svg.addEventListener('mousemove', drag);
    svg.addEventListener('mouseup', endDrag);
    svg.addEventListener('mouseleave', endDrag);

    let selectedElement;

    function startDrag(evt) {
        if (evt.target.classList.contains('draggable')) {
            selectedElement = evt.target;
            //console.log(evt.target)
            offset = getMousePosition(evt);
            offset.x -= parseFloat(selectedElement.getAttributeNS(null, "cx"));
            offset.y -= parseFloat(selectedElement.getAttributeNS(null, "cy"));
        }
    }
    function drag(evt) {
        if (selectedElement) {
            evt.preventDefault();
            let coord = getMousePosition(evt);
            selectedElement.setAttributeNS(null, "cx", coord.x - offset.x);
            selectedElement.setAttributeNS(null, "cy", coord.y - offset.y);
        }
    }
    function endDrag(evt) {
        selectedElement = null;
    }

    function getMousePosition(evt) {
        let CTM = svg.getScreenCTM();
        return {
            x: (evt.clientX - CTM.e) / CTM.a,
            y: (evt.clientY - CTM.f) / CTM.d
        };
    }
}

// Options for the observer (which mutations to observe)
const config = { attributes: true, childList: false, subtree: true };

a = new MutationObserver((mutationList, observer) => {
    for (const mutation of mutationList) {
    if (mutation.type === "attributes") {

        if(mutation.attributeName === "cx"){
            document.getElementById("seg2").setAttributeNS(null, "x2", B.getAttributeNS(null, mutation.attributeName));
            document.getElementById("seg2").setAttributeNS(null, "x1", C.getAttributeNS(null, mutation.attributeName));
        }
        if(mutation.attributeName === "cy"){
            document.getElementById("seg2").setAttributeNS(null, "y2", B.getAttributeNS(null, mutation.attributeName));
            document.getElementById("seg2").setAttributeNS(null, "y1", C.getAttributeNS(null, mutation.attributeName));
        }
    
    }
  }
})
a.observe(B, config);
a.observe(C, config);

let pseq = document.getElementById("pointseq");

a = new MutationObserver((mutationList, observer) => {
    for (const mutation of mutationList) {
    if (mutation.type === "attributes") {
        let a = math.matrixFromRows([document.getElementById("center1").getAttributeNS(null, "cx"), document.getElementById("center1").getAttributeNS(null, "cy")]);
        let b = math.matrixFromRows([document.getElementById("A").getAttributeNS(null, "cx"), document.getElementById("A").getAttributeNS(null, "cy")]);
        let c = math.subtract(a, b);
        console.log(c);
        document.getElementById("dist1").setAttributeNS(null, "value", math.sqrt(math.min(math.add(math.dotPow(math.column(c, 0),2), math.dotPow(math.column(c, 1),2)))))
    }
  }
})
a.observe(document.getElementById("A"), config);
a.observe(document.getElementById("center1"), config);

a = new MutationObserver((mutationList, observer) => {
    for (const mutation of mutationList) {
    if (mutation.type === "attributes") {
        document.getElementById("circ1").setAttributeNS(null, "cx", document.getElementById("center1").getAttributeNS(null, "cx"));
        document.getElementById("circ1").setAttributeNS(null, "cy", document.getElementById("center1").getAttributeNS(null, "cy"));
        document.getElementById("circ1").setAttributeNS(null, "r", document.getElementById("dist1").getAttributeNS(null, "value"));
    }
  }
})
a.observe(document.getElementById("center1"), config);
a.observe(document.getElementById("dist1"), config);


]]></script>

</svg>